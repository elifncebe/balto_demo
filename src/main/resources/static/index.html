<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#151326">
    <title>Balto - Logistics Management System</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/main.css" rel="stylesheet">
    <link href="/css/updated-mobile-app.css" rel="stylesheet">
    <link href="/css/shipment-form.css" rel="stylesheet">

    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Axios for API calls -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Mobile App Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Balto Logistics">
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body>
    <!-- Root element for React application -->
    <div id="app"></div>
    
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS (React components) -->
    <script type="text/babel" src="/js/pages/HomePage.js"></script>
    <script type="text/babel" src="/js/pages/MessagesPage.js"></script>
    <script type="text/babel" src="/js/pages/ProfilePage.js"></script>
    <script type="text/babel" src="/js/pages/CreateShipmentPage.js"></script>
    <script type="text/babel" src="/js/app.js"></script>

    <!-- App Initialization -->
    <script type="text/babel">
        // Main App Component
        function App() {
            const route = useRouter();
            const auth = useAuth();

            if (auth.loading) {
                return (
                    <div className="loading-container">
                        <div className="loading-spinner"></div>
                        <p>Loading application...</p>
                    </div>
                );
            }

            // If user is not authenticated, show login
            if (!auth.user) {
                return <Login />;
            }

            // Route based on hash
            switch(route) {
                case 'messages':
                    return <MessagesPage />;
                case 'profile':
                    return <ProfilePage />;
                case 'create-shipment':
                    return <CreateShipmentPage />;
                default:
                    return <HomePage />;
            }
        }

        // Render the application
        const root = ReactDOM.createRoot(document.getElementById('app'));
        root.render(
            <AuthProvider>
                <App />
            </AuthProvider>
        );
    </script>
</body>
</html>